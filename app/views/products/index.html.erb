<%= render "shared/breadcrumbs" %>
<h1>All Products</h1>

<h2>Search Products</h2>
<%= form_with url: products_path, method: :get, local: true do %>
  <div>
    <%= label_tag :search, "Keyword:" %>
    <%= text_field_tag :search, params[:search] %>

    <%= label_tag :category_id, "Category:" %>
    <%= select_tag :category_id, options_for_select([["All", ""]] + Category.all.map { |c| [c.name, c.id] }, selected: params[:category_id]) %>

    <%= submit_tag "Search" %>
  </div>
<% end %>




<h2>Filter Products</h2>
<ul>
  <li><%= link_to "All Products", products_path %></li>
  <li><%= link_to "On Sale", products_path(filter: "on_sale") %></li>
  <li><%= link_to "New Products", products_path(filter: "new") %></li>
  <li><%= link_to "Recently Updated", products_path(filter: "updated") %></li>
</ul>

<hr>

<% if @products.any? %>
  <% @products.each do |product| %>
    <div style="border: 1px solid #ccc; padding: 10px; margin-bottom: 20px;">
      <h2><%= link_to product.name, product_path(product) %></h2>

      <% if product.image.attached? %>
        <%= image_tag url_for(product.image), size: "200x200" %>
      <% else %>
        <p><strong>No image available</strong></p>
      <% end %>

      <p><%= product.description %></p>
      <p><strong>Price:</strong> $<%= product.price %></p>
      <p><strong>Stock:</strong> <%= product.stock %></p>
      <p><strong>Category:</strong> <%= product.category.name if product.category %></p>
    </div>
  <% end %>

  <div style="margin-top: 20px;">
    <%= paginate @products %>
  </div>
<% else %>
  <p>No products found for this filter.</p>
<% end %>
